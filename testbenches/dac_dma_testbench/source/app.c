/********************************************************************************
  @file     App.c
  @brief    Application functions
  @author   N. Magliola, G. Davidov, F. Farall, J. Gayt√°n, L. Kammann, N. Trozzo
 *******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "dac_dma.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/

#define FRAME_SIZE	1024
#define SAMPLE_RATE	44100

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/

static void updateCallback(uint16_t * frameToUpdate);

/*******************************************************************************
 * VARIABLES TYPES DEFINITIONS
 ******************************************************************************/

// typedef int  my_int_t;

/*******************************************************************************
 * PRIVATE VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

static uint16_t buffers[2][FRAME_SIZE];

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

/* Called once at the beginning of the program */
void appInit (void)
{
    dacdmaInit();

    dacdmaSetBuffers(buffers[0], buffers[1], FRAME_SIZE, updateCallback);

    dacdmaSetFreq(SAMPLE_RATE);

    dacdmaStart();
}

/* Called repeatedly in an infinite loop */
void appRun (void)
{

}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

static void updateCallback(uint16_t * frameToUpdate)
{
	static uint8_t i = 0;
	if (++i == 10)
	{
		i = 0;
	}
	for (uint8_t j = 0 ; j < FRAME_SIZE ; j++)
	{
		frameToUpdate[j] = i * 100 + j;
	}
}


/*******************************************************************************
 ******************************************************************************/
